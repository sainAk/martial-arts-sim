const f=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}};f();const m=(e,a=null,r=1)=>{a===void 0&&([e,a]=[0,e]);let i=[];for(let t=e;t<a;t+=r)i.push(t);return i},p=(e,a)=>`./assets/images/${e}/${a}.png`,g=async e=>new Promise((a,r)=>{let i=document.createElement("img");i.onload=()=>a(i),i.src=e}),b=()=>{g("./assets/images/background.jpg").then(e=>{n.background.image=e})},k=()=>{for(const e in n.actions){const a=n.actions[e];Promise.all(a.frames.map(r=>g(p(a.name,r)))).then(r=>{a.images=r})}},y=(e,a,r,i)=>{const t=n.character.position.x+r;t>=0&&t<=e-n.character.width&&(n.character.position.x+=r);const o=n.character.position.y+i;o>=0&&o<=a-n.character.height&&(n.character.position.y+=i)};let u=[],l=null;const w=(e,a,r)=>{a.images.forEach((i,t)=>{const o=setTimeout(()=>{e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(n.background.image,0,0,e.canvas.width,e.canvas.height),e.drawImage(i,n.character.position.x,n.character.position.y,n.character.width,n.character.height)},t*n.animationSpeed);u.push(o)}),l=setTimeout(r,a.images.length*n.animationSpeed)},v=()=>{u.forEach(e=>{clearTimeout(e)}),u=[],l&&clearTimeout(l),l=null},n={animationSpeed:100,background:{width:800,height:600,image:new Image},character:{height:500,width:500,position:{x:0,y:0}},actions:{idle:{name:"idle",frames:m(1,8),images:[]},backward:{name:"backward",frames:m(1,6),kbKey:"a",buttonId:"backward",images:[],moveX:-50},forward:{name:"forward",frames:m(1,6),kbKey:"d",buttonId:"forward",images:[],moveX:50},punch:{name:"punch",frames:m(1,7),kbKey:"p",buttonId:"punch",images:[]},kick:{name:"kick",frames:m(1,7),kbKey:"k",buttonId:"kick",images:[]},block:{name:"block",frames:m(1,9),kbKey:"l",buttonId:"block",images:[]}}};function I(){const e=document.getElementById("canvas"),a=e.getContext("2d"),r=Object.keys(n.actions);b(),k();let i="idle",t=()=>{w(a,n.actions[i],t),i="idle"};t();const o=c=>{var s;v(),y(e.width,e.height,(s=c.moveX)!=null?s:0,0),i=c.name,t()};r.forEach(c=>{var d,h;let s=n.actions[c];(h=document.getElementById((d=s.buttonId)!=null?d:""))==null||h.addEventListener("click",()=>{o(s)})}),document.addEventListener("keydown",c=>{r.forEach(s=>{let d=n.actions[s];c.key===d.kbKey&&o(d)})})}document.addEventListener("DOMContentLoaded",I);
